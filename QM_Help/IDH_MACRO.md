# 宏

![宏图标](../image/icon_macro.gif)

宏是一系列命令的列表，如“输入文本”、“运行文件”或其他语句。参见[语法](../Reference/IDP_SYNTAX.html)和[帮助与类型信息](IDH_TYPEINFO.html)。

## 创建与编辑
可在编辑器中直接输入宏命令，也可通过[录制](IDH_RECORD.html)键盘和鼠标事件，或使用代码工具栏的对话框。

## 执行
启动宏时，QM 编译并执行宏。运行期间，托盘图标变为 ![运行中图标](../image/qm_icon_running.png)。宏在以下情况停止：
- 执行完最后命令。
- 某命令指示停止。
- 发生错误。

可通过“选项”中设置的热键（默认 Pause）手动停止运行宏。

## 运行限制
默认一次仅运行一个宏。若需同时运行多个线程，可在“属性”对话框设置“同时运行”选项，或使用[函数](IDH_FUNCTION.html)。

### QM 2.4.2 新增“同时运行”选项
之前版本需将宏转换为函数以实现同时运行，现可通过“属性”对话框启用此选项。启用后，宏具有以下函数特性：
- 可在其他宏运行时启动，其他宏也可在其运行时启动。
- 运行时 QM 托盘图标不变。
- 无法通过“终止宏”热键（默认 Pause）或菜单命令终止线程，需通过“运行项目”面板或“线程”对话框（托盘图标菜单）终止。
- 终止线程时，不释放代码（如 `key+ C`）留下的修饰键。
- “自动最小化 QM”设置不适用。