# 网络设置

Quick Macros 需在每台使用它的计算机上安装，除非使用[便携式 QM](IDP_PORTABLE.html)。

## 共享和部署 QM 文件
若需在多台计算机或用户账户上同时使用同一[QM 文件](IDH_QML.html)（以下简称 *文件 F*）：
- **注意**：QM 2.4.0 更改了文件格式和打开方式。
- QM 打开文件时，其他 QM 实例（其他计算机/账户）无法打开该文件，除非以只读模式打开。
- 每台计算机/用户需有自己的主文件。通过菜单“文件 -> 导入”将文件 F 添加为主文件的共享文件，将创建带有 S 字母图标的虚拟文件夹，加载文件 F 的项目。
- 通常仅一台计算机（以下简称 *计算机 A*）应以可编辑模式打开文件 F。为防止其他计算机以可编辑模式打开（导致计算机 A 不可用），在其他计算机上右键点击 S 文件夹，选择“文件夹属性 -> 共享文件 -> 加载本地只读副本”。
- 在计算机 A 上修改文件 F 后，其他计算机的 QM 在启动或重新加载主文件时加载文件 F（或其副本）。**注意**：QM 不会立即将更改写入 .qml 文件，详见 [QM 文件](IDH_QML.html)。

QM 安装程序运行时，若在其文件夹中找到 Main.qml 文件，会将该文件设为该用户的默认主文件。可利用此功能自动化在多台计算机上安装相同的修改主文件。例如，只需在一台计算机上添加共享文件 F（路径需在所有计算机上有效）。

“加载本地只读副本”功能在网络文件 F 启动时不可用时也很有用，QM 会加载之前使用的本地副本。

## 部署 QM 注册表设置
QM 将大部分设置保存在每个用户的注册表中。导出设置到 qmreg5.reg 文件：点击“选项 -> 常规 -> 导出设置”。

QM 安装程序运行时，若在其文件夹中找到 qmreg5.reg 文件，会将该文件安装到 QM 文件夹。首次在用户账户运行 QM 时，会将 qmreg5.reg 的设置导入该用户注册表，并在 `HKCU\Software\GinDi\QM2\settings` 注册表键中设置 `"reg loaded"=1` 以防止重复导入。**注意**：需管理员权限（可能显示 UAC 同意提示）。

**QM 2.4.0**：自定义工具栏位置/样式设置现保存在主文件中，而非注册表。

**注意**：导出的 reg 文件包含当前主 QM 文件路径。需用记事本打开 reg 文件，编辑 QM 文件路径（`"file"`）及其他文件路径（若在其他计算机上不同）。路径中可使用特殊文件夹字符串，如 `$qm$`（QM 程序文件夹）和 `$my qm$`（我的文档\My QM）。通常无需编辑，因 QM 使用特殊文件夹字符串保存路径。

## 部署宏
使用函数 [NetSendMacro](../Functions/NetSendMacro.html) 将宏发送到其他计算机，使用 [net 命令](../Commands/IDP_NET.html) 执行，详见 [net 主题](IDP_NET.html)。

## 注册
在每台计算机上输入 QM 注册码。在多用户计算机上，若以管理员身份登录，注册会自动应用于所有用户账户。

## 升级
升级 QM 时，在每台计算机上安装新版本。

---

**另见**：[安装命令行参数](IDP_SETUP.html)、[许可证](IDP_LICENSE.html)