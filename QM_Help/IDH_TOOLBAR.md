# 工具栏

工具栏用于启动宏、文件或其他命令。其语法与 [弹出菜单](IDH_POPUP.md) 相同，但工具栏不支持子菜单。

## 工具栏类型

工具栏可以是**自由**的或**附着**在窗口上的：

- **附着工具栏**：
  - 工具栏的拥有者为窗口，始终位于窗口顶部。
  - 窗口最小化或隐藏时，工具栏隐藏；窗口销毁时，工具栏销毁。
  - 可选择在窗口移动或调整大小时跟随窗口。
  - 工具栏可附着在多个窗口，创建多个实例；一个窗口可拥有多个不同附着工具栏。
- **自由工具栏**：
  - 未附着在窗口，始终位于最前端。

## 附着工具栏的两种方式

1. **分配 [窗口触发器](IDH_TRIG_WINDOW.md)**：
   - 在工具栏的 **Properties** 对话框中设置窗口触发器，使工具栏自动附着到指定窗口。

2. **使用 [mac](IDP_MAC.md) 命令启动**：
   - 以窗口句柄作为命令参数启动工具栏。例如：

     ```qm
     mac "Toolbar9" win("Calc")
     ```

## 未附着工具栏

若通过其他方式启动（如直接运行工具栏而非通过窗口触发器或 `mac` 带窗口句柄），工具栏为自由工具栏，始终位于最前端。

## 工具栏句柄

- 从工具栏启动的宏通过 `_command` 变量接收工具栏窗口句柄，使用 `val(_command)` 获取。
- 使用 [mac](IDP_MAC.md) 启动工具栏时，返回工具栏窗口句柄（即使工具栏已运行）。

## 操作提示

- **移动工具栏**：用鼠标右键拖动。
- **移动或删除按钮**：按住 Shift 键拖动。
- **添加按钮**：
  - 拖放宏、文件或网络链接到工具栏或编辑器文本。
  - 按住 Ctrl 键可用于快捷方式。
  - 将文件拖放到程序图标上，可选择在该程序中打开文件。
- **右键菜单**：右键点击工具栏显示上下文菜单。
- **隐藏按钮文本**：在行首插入制表符（仍可看到工具提示）。

## 相关内容

- [快速入门](IDH_QUICK.md)
- [工具栏右键菜单](IDH_TOOLBARMENU.md)
- [工具栏属性](IDH_TOOLBAROPTIONS.md)
- [扩展工具栏](IDH_EXTOOLBAR.md)
- `DynamicToolbar`
- [GetToolbarOwner](IDP_QMDLL.md#GetToolbarOwner)