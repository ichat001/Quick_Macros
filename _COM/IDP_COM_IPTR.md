# 接口指针变量

接口指针变量是对 COM 对象的引用，用于调用 COM 对象函数。声明语法如下：

```qm
Interface ip
```

- **Interface**：接口名称或 coclass 名称。
- **ip**：变量名称。
  - 如果使用接口名称，变量类型为 **Interface**。
  - 如果使用 coclass 名称，变量类型为该 coclass 的默认接口类型。

通常，coclass 和接口在类型库中声明。您应同时使用类型库名称，例如：

```qm
Excel.Application app
```

将一个接口指针变量赋值给另一个（例如使用 `=` 运算符）不会复制对象，仅增加对象的引用计数。两个变量将指向同一对象，操作很快。QM 可能在赋值操作中因接口指针类型不匹配而生成错误。使用 [运算符 +](IDP_OPUNARY.md) 可避免编译错误。如果不支持该接口，将在运行时生成错误。例如：

```qm
Interface1 a._create
Interface2 b=+a
```

要显式删除对象，将接口指针变量赋值为 0，这会减少对象的引用计数。不需要显式删除，因为 QM 会在变量超出作用域时自动执行此操作。您不应调用 `AddRef` 或 `Release`，因为 QM 会自动管理引用计数。

COM 对象通常不能被多个线程使用，因此接口指针变量应声明为 [局部或线程作用域](IDP_VARIABLES.md)（参见 [作用域](IDP_SCOPE.md)）。

接口指针变量本身不是对象，仅是指向对象的指针，也是指向接口的双重指针。与其他指针一样，它是一个 4 字节整数。