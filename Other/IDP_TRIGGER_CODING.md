# 触发器编码

触发器可以通过 **Properties** 对话框设置，也可在工具栏的“Trigger”字段中直接写入编码的触发器字符串。以下介绍各种触发器类型的编码格式。

## [热键触发器](IDH_TRIG_KEY.md)

**语法**：

```syntax
[mod]key[nextkey] [flags]
```

- 使用与 [key](IDP_KEY.md) 命令相同的 [QM 键码](IDP_KEYCODES.md)。
- 字符串以可选修饰键（`C` - Ctrl，`S` - Shift，`A` - Alt，`W` - Win）开头。
- 随后是一个或两个键，可使用括号中的 [虚拟键码](IDP_VIRTUALKEYS.md)（必须为数字，非命名常量）。
- 可选地以空格和标志（未文档化）结尾。

**示例**：

| 触发器字符串 | 说明 |
|--------------|------|
| `F9`         | F9 键 |
| `CSc`        | Ctrl+Shift+C |
| `Awe`        | Alt+W+E |
| `q 0x5`      | Q 键，不吞噬按键，等待释放 |

## [鼠标触发器](IDH_TRIG_MOUSE.md)

**语法**：

```syntax
#[#][mod]trigger[monitor|hittest] [flags]
```

- 以 `#` 开头（双击为 `##`）。
- 随后是可选修饰键（`C`、`S`、`A`）。
- 鼠标触发类型：
  - 按钮：`L`（左键）、`R`（右键）、`M`（中键）、`X1` 或 `X2`（扩展按钮）。
  - 滚轮：`U`（向上）、`D`（向下）。
  - 屏幕边缘：1-12（顺时针，从左上角开始）。
  - 鼠标移动方向：`<`（左）、`>`（右）、`v`（下）、`^`（上），及区域编号（1 - 上/左，2 - 中间，3 - 下/右）。
- 可选地指定监视器索引（`m` + 1-30，或仅 `m` 表示所有监视器）或 [命中测试代码](IDH_TFF.md)（`h` + 1-30）。
- 可选地以空格和标志（未文档化）结尾。

**示例**：

| 触发器字符串 | 说明 |
|--------------|------|
| `#SR`        | Shift+鼠标右键 |
| `#CSD`       | Ctrl+Shift+鼠标滚轮向后 |
| `##12`       | 鼠标两次移到屏幕左上边缘 |
| `#A>3`       | Alt+鼠标在屏幕底部区域右左移动 |
| `#Lh2 0x1`  | 在窗口标题栏左键单击，不吞噬 |

## [窗口触发器](IDH_TRIG_WINDOW.md)

**语法**：

```syntax
!triggertype"name" ["class"] ["childname"] ["childclass"] [style] [flags]
```

- 以 `!` 开头。
- 触发类型（1-2 个字母）：
  - `ca`：创建并激活
  - `cv`：创建并可见
  - `a`：激活
  - `i`：停用
  - `v`：可见
  - `n`：名称更改
  - `d`：销毁
- 随后是一个或多个属性（窗口名称、类名、子窗口名称、子窗口类名、样式）。
- 可选地以标志（未文档化）结尾。
- 所有字符串可包含 [转义序列](IDP_CONSTANT.md)。

## [QM 事件触发器](IDH_TRIG_QM.md)

- 以 `@` 开头，未文档化。

## 其他触发器

- 以 `$` 开头，未文档化。

## [用户定义触发器](IDH_TRIG_EXT.md)

- 以 `^` 开头，后跟触发器管理函数名称及可选的由触发器定义的额外数据。

## 作用域（仅限热键、鼠标、窗口和文本触发器）

若触发器仅对特定程序或除特定程序外有效，在触发器代码后加空格、`/` 和逗号分隔的程序名称。若对除某些程序外的所有程序有效，使用 `\`。

**示例**：

| 触发器字符串                     | 说明 |
|----------------------------------|------|
| `F12 /NOTEPAD`                  | F12 热键仅在 NOTEPAD 程序的窗口激活时有效 |
| `!ca"Open" \WINWORD,EXCEL`      | “Open”窗口创建触发器在 WINWORD 或 EXCEL 程序的窗口中无效 |

若宏有 [过滤器函数](IDH_TFF.md)：
- 若触发器特定于程序，过滤器函数名称在触发器和程序后以 `/` 分隔。
- 若触发器不特定于程序，过滤器函数名称在触发器代码、空格和 `//` 后。