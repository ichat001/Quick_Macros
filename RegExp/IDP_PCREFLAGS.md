# 正则表达式选项

以下[标志](IDP_FLAGS.md)位可用于 [findrx](IDP_FINDRX.md) 和 [str.replacerx](IDP_S_REPLACERX.md) 函数：

## RX_CASELESS (0x100, 同标志 1)
- 启用后，模式中的字母匹配大小写均可，等同于 Perl 的 `/i` 选项。
- 可通过模式内的 `(?i)` 设置更改。

## RX_MULTILINE (0x200, 同标志 8)
- 默认情况下，PCRE 将目标字符串视为单行（即使包含换行符）。`^` 仅匹配字符串开头，`$` 仅匹配字符串结尾或末尾换行符前（除非设置 `RX_DOLLAR_ENDONLY`）。
- 启用后，`^` 和 `$` 分别匹配换行符后和换行符前的位置，以及字符串的开头和结尾，等同于 Perl 的 `/m` 选项。
- 可通过模式内的 `(?m)` 设置更改。
- 若字符串无 `\n` 或模式无 `^` 或 `$`，则此选项无效。

## RX_DOTALL (0x400)
- 启用后，`.` 元字符匹配包括换行符在内的所有字符，默认不匹配换行符。
- 等同于 Perl 的 `/s` 选项，可通过模式内的 `(?s)` 设置更改。
- 否定字符类（如 `[^a]`）始终匹配换行符，不受此选项影响。

## RX_EXTENDED (0x800)
- 启用后，模式中的空白字符（除垂直制表符，代码 11）被忽略，除非被转义或在字符类内。
- 未转义的 `#`（字符类外）到下一个换行符（含）之间的字符也被忽略，等同于 Perl 的 `/x` 选项。
- 可通过模式内的 `(?x)` 设置更改。
- 便于在复杂模式中添加注释，但空白字符不可出现在特殊字符序列中（如 `(?(`，条件子模式开头）。

## RX_ANCHORED (0x1000)
- 启用后，模式强制“锚定”，仅在目标字符串的首次匹配点开始匹配。
- 可通过模式本身的结构实现（如 `^`），Perl 仅支持后者。

## RX_DOLLAR_ENDONLY (0x2000)
- 启用后，`$` 元字符仅匹配目标字符串的绝对结尾，不匹配末尾换行符前。
- 默认情况下，`$` 匹配字符串结尾或末尾换行符前（非其他换行符前）。
- 若设置 `RX_MULTILINE`，此选项被忽略。
- Perl 无等效选项，且无法在模式内设置。

## RX_EXTRA (0x4000)
- 启用后，模式中反斜杠后接无特殊含义的字母将报错，保留这些组合以备将来扩展。
- 默认（Perl 行为）将反斜杠后接无特殊含义的字母视为字面字符。
- 可通过模式内的 `(?X)` 设置更改。
- 当前无其他功能受此选项控制。

## RX_NOTBOL (0x8000)
- 启用后，字符串的首字符不视为行首，`^` 元字符不匹配。
- 若未设置 `RX_MULTILINE`（编译时），`^` 永不匹配。

## RX_NOTEOL (0x10000)
- 启用后，字符串的末尾不视为行尾，`$` 元字符不匹配（除非在多行模式下匹配换行符前）。
- 若未设置 `RX_MULTILINE`（编译时），`$` 永不匹配。

## RX_UNGREEDY (0x20000)
- 启用后，反转量词的“贪婪”行为，默认非贪婪，量词后加 `?` 变为贪婪。
- 与 Perl 不兼容，可通过模式内的 `(?U)` 设置更改。

## RX_NOTEMPTY (0x40000)
- 启用后，空字符串不视为有效匹配。
- 若模式包含替代分支，将尝试其他分支；若所有分支匹配空字符串，整个匹配失败。

## RX_UTF8 (0x80000, QM 当前不支持)
- 启用后，模式和目标字符串视为 UTF-8 字符字符串，而非单字节字符串。

## RX_NO_AUTO_CAPTURE (0x100000)
- 启用后，禁用模式中编号捕获括号的使用。
- 未后接 `?` 的开括号视为后接 `?:`（非捕获），但命名括号仍可用于捕获并按常规分配编号。
- Perl 无等效选项。

## RX_NO_UTF8_CHECK (0x200000, QM 当前不支持)
- 启用后，不检查 UTF-8 是否有效，速度更快但可能不安全。