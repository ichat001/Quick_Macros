# 标志（Flags）

许多函数具有称为“标志”（flags）的参数，这些参数可以由多个值（位）组成。使用按位或运算符 `|` 将多个值组合成标志。例如：

```qm
int hwnd=win("Window" "" "" 1|8)
SetWindowPos(hwnd HWND_TOPMOST 0 0 0 0 SWP_NOSIZE|SWP_NOMOVE|SWP_SHOWWINDOW)
```

标志值通常是 2 的倍数（1、2、4、8、16 等）。在这种情况下，`|` 运算符等同于 `+` 运算符。例如，指定标志 1、4 和 16，可以使用 `1|4|16` 或 `21`。标志以十六进制格式更易读，因此可使用 `0x15` 代替 `21`。另一个示例：`5|0x10`。

一个标志占用 1 位，因此 `int` 值可包含 32 个标志：1、2、4、8、0x10、0x20、0x40、0x80、0x100 ... 0x80000000。

如果标志是函数的可选参数，默认值为 0。

## 如何比较标志

通常需要判断某个标志是否被设置，使用按位与运算符 `&`。例如：

```qm
if(flags&8)
```

不要使用 `=` 运算符（如 `if(flags=3)`），通常没有意义。

## 如何从十六进制数读取标志或反之

QM 对话框生成的代码常包含十六进制格式的标志，如 `0x3011`。如何知道其中编码了哪些标志？

首先，了解 [十六进制数](https://en.wikipedia.org/wiki/Hexadecimal) 和 [标志字段](https://en.wikipedia.org/wiki/Flag_field) 的格式。

每个十六进制位（0x 后的数字）是该位置最多四个标志的和：1、2、4 和 8。

**示例**：
- `0x5` 包含标志 `0x4`（4）和 `0x1`（1）。
- `0x500` 包含标志 `0x400`（1024）和 `0x100`（256）。
- `0x52A` 包含标志 `0x400`、0x100`、`0x20`、`0x8` 和 `0x2`。
- `0x3011` 包含标志 `0x2000`、`0x1000`、`0x10` 和 `0x1`。

**标志表**：

| 十六进制位 | 标志 |
|------------|------|
| 0 | 无 |
| 1 | 1 |
| 2 | 2 |
| 3 | 1, 2 |
| 4 | 4 |
| 5 | 4, 1 |
| 6 | 4, 2 |
| 7 | 4, 2, 1 |
| 8 | 8 |
| 9 | 8, 1 |
| A | 8, 2 |
| B | 8, 2, 1 |
| C | 8, 4 |
| D | 8, 4, 1 |
| E | 8, 4, 2 |
| F | 8, 4, 2, 1 |

**添加标志**：将标志值与现有十六进制数按位或（`|`），避免重复添加。例如，添加 `0x100` 到 `0x402`：

```qm
0x402|0x100 = 0x502
```

**移除标志**：使用按位与非（`&~` 或 QM 中的 `~`）移除标志。例如，移除 `0x100` 从 `0x5C0`：

```qm
0x5C0~0x100 = 0x4C0
```

**注意**：不要将十六进制标志数（如 `0x3011`）转换为十进制，十进制值无意义。但单个标志可转换为十进制以简化书写，例如用 `4` 代替 `0x4`，或 `16` 代替 `0x10`。