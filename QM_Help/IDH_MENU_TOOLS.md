# 运行、调试、工具、输出菜单

部分菜单命令在[工具栏](IDH_MENU_TOOLBAR.html)主题中有描述，以下为其他命令。

## 运行
- **显示可能的运行时错误**  
  编译宏/函数时，显示可能的运行时错误，详见 [err 帮助](../Flow/IDP_ERR.html)。

- **显示未使用变量**  
  编译宏/函数时，若声明的[局部或线程变量](../Language/IDP_SCOPE.html)未使用，则显示“未使用变量”警告。  
  - QM 无法始终准确检测变量是否使用，可能产生多余警告，如某些对话框变量可能触发警告。仅在确认变量确实未使用时删除声明。  
  - 函数参数及带赋值的声明（如 `int k=0` 或 `str s.getwintext(w)`）不显示警告。  
  - 使用 `#opt nowarnings 1` 可禁用函数中的警告，可放于函数末尾。  
  - 若变量仅在排除编译的代码（如 `#if`）中使用，将变量声明移至该代码中以避免警告。

- **显示引用文件中的声明**  
  显示从[引用文件](../Language/IDP_REF.html)检索的声明。

- **显示加载的 DLL 和类型库**  
  显示实际加载的 [DLL](../Language/IDP_DLL.html) 和[类型库](../_COM/IDP_TYPELIB.html) 名称。

- **备注**：声明和加载文件信息在编译宏或显示在代码编辑器时会在 QM 输出中显示。  
  **提示**：使用 [CompileAllItems](../User/IDP_QMDLL.html#CompileAllItems) 可编译多个函数。

- **查看活动项目**  
  显示/隐藏 QM 窗口中的“活动项目”和“运行项目”列表。“运行项目”列表显示当前运行的[线程](../Other/IDP_THREADS.html)、工具栏、定时器和最近启动的项目。右键项目可终止线程、查找丢失工具栏或停止定时器。

- **自动最小化 QM**  
  点击“运行”按钮或菜单运行宏时最小化 QM，仅适用于未启用“同时运行”选项的宏。

- **禁用触发器**  
  勾选后，QM 不响应大多数触发器事件（根据“选项”设置）。  
  - 其他禁用/启用方式：托盘图标菜单、中键点击托盘图标、Ctrl+Shift+Alt+D、[dis 命令](../Commands/IDP_DIS.html)。  
  - 仅在特定程序中禁用触发器，使用[文件属性](IDH_FOLDERPROP.html)对话框。  
  - QM 启动时按住 F8 可选择安全模式，禁用所有触发器，宏和函数无法以任何方式运行。

- **创建 EXE、运行 EXE**  
  从当前宏/函数[创建或运行 EXE 文件](IDH_MAKEEXE.html)。

## 调试
运行或控制[调试模式](../Flow/IDP_DEB.html)中的宏，设置调试模式选项。

## 工具
- **录制菜单**  
  录制菜单命令 ([men](../Commands/IDP_MEN.html))，在窗口中点击菜单项时记录。并非所有菜单可录制，若无法录制，说明 [men 命令](../Commands/men.html) 不适用。录制时，窗口不接收菜单命令，除非按 Shift 点击。

- **COM 库**  
  查看注册的 COM 类型库和 ActiveX 控件，插入[类型库声明语句](../_COM/IDP_TYPELIB.html)，注册/取消注册 COM 组件。

- **便携式 QM**  
  在可移动驱动器中安装[便携式 QM](../Other/IDP_PORTABLE.html)。

## 输出
- **打开选定项目**  
  打开 QM 输出中完全选中的项目名称。

- **日志 -> 窗口事件**  
  窗口激活、创建等时，在输出中显示其句柄、类和名称，适用于难以设置窗口触发器的场景。

- **日志 -> 可访问对象事件**  
  记录可访问对象事件，以获取可访问对象触发器所需信息。

- **历史记录**  
  显示最近 32 个 QM 输出事件，可查看 [out 命令](../Commands/out.html) 的调用位置和时间。对于在分离进程中运行的宏，记录信息较少。右键菜单：  
  - **定位**：打开生成输出事件的宏/函数并显示相应语句。  
  - **调用者**：打开调用该函数的宏/函数。