# 菜单属性

通过[属性](IDH_POPUP.html)对话框设置[菜单](IDH_POPUP.html)属性，属性位于菜单文本首行，也可直接编辑。

## 语法
```plaintext
 /option1 [parameters] [/option2 [parameters] ...]
```
- 以空格或分号分隔，一个或多个选项。
- 每个选项以 `/` 开头，可带 1-2 个参数。
- 未使用的参数可省略或用 `""`。

部分选项在[菜单](IDH_POPUP.html)主题中有详细说明。

## 可用选项
1. **设置菜单位置**  
   ```
   /pos position
   ```
   - **position**：`mouse`（默认，鼠标位置）、`text`（文本光标位置）、`center`（屏幕中央）。

2. **不显示图标**  
   ```
   /noicons
   ```

3. **点击菜单项时关闭菜单但不运行关联命令**  
   ```
   /dontrun
   ```
   - 适用于通过代码（如 [mac 命令](../Commands/mac.html)）启动的菜单。

4. **禁用右键菜单中的“编辑项目”**  
   ```
   /noedit
   ```

5. **展开文件文件夹**  
   ```
   /expandfolders flags level
   ```
   - 详见[菜单](IDH_POPUP.html)。
   - **flags**（[标志](../Other/IDP_FLAGS.html)）：
     | 值 | 描述 |
     |----|------|
     | 1  | 排除非文件系统对象（如控制面板文件夹）。 |
     | 2  | 排除文件夹。 |
     | 4  | 显示隐藏文件/文件夹。 |
     | 8  | 展开文件夹中的快捷方式（仅限已展开文件夹中的快捷方式）。 |
     | 16 | 仅包含文件夹（与标志 2 不兼容）。 |
     | 32 | 在子菜单顶部添加“此文件夹”项，打开子菜单来源文件夹。 |
     | 128 | 显示菜单时在输出中显示路径，适用于查看非文件系统对象（如回收站）的路径。设置此标志时，`/folder` 不生效。 |
   - **level**：限制子菜单层级。例如：1（仅文件夹）、2（文件夹\子文件夹）、3（文件夹\子文件夹\子文件夹）。

6. **文件过滤（用于 /expandfolders）**  
   ```
   /filter include exclude
   ```
   - 指定包含或排除的文件，使用 `|` 分隔，支持[通配符](../Other/IDP_WILDCARD.html)。
   - 若 `include`/`exclude` 含 `\` 或 `:`，按完整路径评估；否则仅按文件名评估。
   - 非文件系统对象按路径（通常为类 ID 字符串）评估，可通过“属性”对话框中的“显示路径”（标志 128）查看路径。
   - **示例**：
     - `*.txt`：txt 文件。
     - `*.exe|*.com|*.bat`：这三种类型的文件。
     - `jun*`：以“jun”开头的文件。
     - `C:\*\*`：排除 C:\ 根目录文件，但包含子文件夹文件。
     - `?:\*\*`：所有驱动器的根目录文件。

7. **文件夹/驱动器过滤（用于 /expandfolders）**  
   ```
   /filterfolders include exclude
   ```
   - 与 `/filter` 类似，但仅适用于文件夹和驱动器。
   - **示例**：
     - `C:\`：C: 驱动器。
     - `A:\|D:\`：A: 和 D: 驱动器。
     - `::{645FF040-5081-101B-9F08-00AA002F954E}`：回收站。

8. **设置菜单项背景图像**  
   ```
   /bmp file
   ```
   - 支持 bmp、gif、jpg，QM 2.3.4 起支持 png。图像平铺，可小于菜单项大小。

9. **设置高亮菜单项背景图像**  
   ```
   /bmpsel file
   ```
   - 图像平铺。

10. **设置普通和高亮菜单项文本颜色**  
    ```
    /tcol color colorsel
    ```
    - **color** 和 **colorsel**：使用 [0xBBGGRR 格式的颜色](../Other/IDP_COLOR.html)。

11. **多列显示 (QM 2.3.0)**  
    ```
    /multicolumn
    ```
    - 菜单项超出屏幕高度时使用多列显示。展开的文件文件夹始终多列显示，不受此选项影响。