# 字符代码

字符串（文本）由字符（字母、数字、空格等）组成。每个字符存储为一个数值，即**字符代码**，不同的值显示为不同的字符。

## 字符集
字符集有多种类型：
- **ANSI 字符集**：字符代码为单字节。
- **[Unicode](IDP_UNICODE.md) 字符集**：字符代码根据编码方式占 1-4 字节。
- **ASCII 字符**（0-127）：在所有字符集中相同，见下表。
- 使用 Windows 的“字符映射表”程序（`run "charmap"`）可查看所有字符集的字符。

## 常用低值字符（0-31）
以下为常用的低值字符，其余 0-31 范围的字符较少使用：

| 代码 | 字符描述 |
|------|----------|
| 0    | 终止空字符，用于字符串末尾。 |
| 9    | 制表符（Tab）。 |
| 10   | 换行符（Linefeed）。 |
| 13   | 回车符（Carriage Return）。Windows 中换行符为 13 10（`\r\n`）。 |

## ASCII 字符（32-127）

| 代码 | 字符 | 代码 | 字符 | 代码 | 字符 |
|------|------|------|------|------|------|
| 32   | 空格 | 64   | @    | 96   | `    |
| 33   | !    | 65   | A    | 97   | a    |
| 34   | "    | 66   | B    | 98   | b    |
| 35   | #    | 67   | C    | 99   | c    |
| 36   | $    | 68   | D    | 100  | d    |
| 37   | %    | 69   | E    | 101  | e    |
| 38   | &    | 70   | F    | 102  | f    |
| 39   | '    | 71   | G    | 103  | g    |
| 40   | (    | 72   | H    | 104  | h    |
| 41   | )    | 73   | I    | 105  | i    |
| 42   | *    | 74   | J    | 106  | j    |
| 43   | +    | 75   | K    | 107  | k    |
| 44   | ,    | 76   | L    | 108  | l    |
| 45   | -    | 77   | M    | 109  | m    |
| 46   | .    | 78   | N    | 110  | n    |
| 47   | /    | 79   | O    | 111  | o    |
| 48   | 0    | 80   | P    | 112  | p    |
| 49   | 1    | 81   | Q    | 113  | q    |
| 50   | 2    | 82   | R    | 114  | r    |
| 51   | 3    | 83   | S    | 115  | s    |
| 52   | 4    | 84   | T    | 116  | t    |
| 53   | 5    | 85   | U    | 117  | u    |
| 54   | 6    | 86   | V    | 118  | v    |
| 55   | 7    | 87   | W    | 119  | w    |
| 56   | 8    | 88   | X    | 120  | x    |
| 57   | 9    | 89   | Y    | 121  | y    |
| 58   | :    | 90   | Z    | 122  | z    |
| 59   | ;    | 91   | [    | 123  | {    |
| 60   | <    | 92   | \    | 124  | \|   |
| 61   | =    | 93   | ]    | 125  | }    |
| 62   | >    | 94   | ^    | 126  | ~    |
| 63   | ?    | 95   | _    | 127  | 未使用 |

## 字符集使用
- **Unicode**：若在 QM 选项中启用 Unicode，QM 使用 Unicode 字符集。Unicode 字符在所有计算机上相同，但并非所有字体支持所有字符。
- **ANSI**：若未启用 Unicode，QM 使用默认 ANSI 字符集。128-255 范围的字符在不同 ANSI 字符集（Western、Baltic、Cyrillic、Greek 等）中显示不同，取决于 Windows 安装时的语言设置或控制面板中的“区域设置 -> 高级/管理 -> 非 Unicode 程序语言”设置。因此，这些字符在不同计算机上可能显示不同。使用“字符映射表”程序可查看各字符集的字符。

## 在宏中使用字符代码
- **获取 ASCII 字符代码**：将字符用单引号括起来。例如，`out 'A'` 输出 65。
- **从字符串变量获取字符代码**：使用 `[]` 运算符。例如：
  ```qm
  str s="ABC"; out s[0]; out s[1]
  ```
- **通过字符代码插入字符**：
  - 使用 `[]` 运算符：
    ```qm
    str s=" "; s[0]='A'
    ```
  - 使用 [format 字段](IDP_PRINTF.html) `%c` 和 [str.format](IDP_S_FORMAT.html) 或其他支持格式化的函数：
    ```qm
    str s.format("%c" 'A')
    ```