# 函数

**另见**：[函数技巧](IDH_FUNCTIONTIPS.html)、[关于函数](../Language/IDH_FUNCTIONS.html)、[函数声明（参数等）](../Language/IDP_FUNCTION.html)、[QM 编程](../Reference/IDH_PROGRAMMING.html)、[类成员函数](../Language/IDP_CLASSES.html)、[子函数](../Language/IDP_DIR_SUB.html)

## 概述
用户定义的函数是可从其他[宏](IDH_MACRO.html)调用的宏。

## 宏与函数的区别
1. **调用方式**：函数可从宏或其他函数调用，允许代码复用，用函数名替代完整代码。函数可[接收参数](../Language/IDP_FUNCTION.html)并[返回值](../Flow/IDP_RET.html)。在代码中，函数名显示为特定颜色。
2. **触发运行**：函数与宏类似，可由用户或触发器启动，可与其他函数或宏同时运行。
3. **托盘图标**：函数运行时，QM 托盘图标不变为红色。
4. **终止运行**：无法通过 Pause 键停止运行函数，需使用“线程”对话框（托盘图标菜单）或“运行项目”列表（菜单“运行 -> 查看活动项目”）。也可用代码如 `ifk(C) break`（若按下 Ctrl 键，退出 `for` 或 `rep` 循环）。
5. **运行速度**：宏初始速度为 100，函数为 0（无自动延迟），可用 [spe](../Commands/IDP_SPE.html) 更改。

## 函数运行限制
默认情况下，函数可由用户或触发器启动，类似宏。为避免意外启动（函数设计为代码调用），可在“属性”对话框设置，在函数文本开头插入特殊行：
```cpp
 /
function ...
...
```
- 以空格和斜杠（` /`）开头，函数仅可通过代码调用（宏、其他函数或回调函数）。通过“运行”按钮、触发器或 `mac` 启动无效。

若函数（或宏、成员函数）开头为空格、斜杠及另一项目名称，按“运行”按钮时运行该项目，适合调试需从代码调用的函数。示例：
```cpp
 /test
function ...
...
```
- 启动此函数时，运行宏 `test`，可能调用该函数。
- 若使用反斜杠（`\`），仅阻止“运行”按钮启动，函数仍可通过 `mac` 或触发器启动。

## 编译与编辑
- QM 按需[编译](IDH_DEBUG.html)函数和宏。
- 可在运行时编辑并保存函数代码，但更改在函数（或其调用的函数）运行期间不生效。例如：
  - 含 `rep` 循环的函数反复执行代码，需下次运行才应用更改。
  - 含对话框过程的函数，因反复调用且通常快速返回，更改立即生效。