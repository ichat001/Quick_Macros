# 格式化日期/时间字符串

注意：此函数已过时。C 风格格式化较慢且存在其他问题，建议使用 [str.timeformat](IDP_S_TIMEFORMAT.md)。

## 语法1 - 标准日期/时间字符串

```
s.time([date])
```

## 语法2 - C 风格日期/时间字符串

```
s.time([date] cfrm [locale] [plusnseconds])
```

## 语法3 - Windows 风格日期/时间字符串

```
s.time([date] winfrmdate [winfrmtime])
```

## 参数

- **s** - str 变量。
- **date** - [DATE](../_COM/IDP_OLE_DATE.md) 类型变量。默认值：当前日期。
- **cfrm** - C 风格的格式控制字符串。
- **locale** - 目标语言，字符串。默认值：""（当前区域设置）。
- **plusnseconds** - 要添加的秒数，可为负数。默认值：0。
- **winfrmdate** - Windows 风格的日期格式控制字符串。若为 ""，使用默认格式；若为 "-"，仅使用时间部分。
- **winfrmtime** - Windows 风格的时间格式控制字符串。若为 ""，使用默认格式；若为 "-" 或省略，仅使用日期部分。

## 备注

可通过代码工具栏中的“文本”对话框插入此函数。

### 语法1
按当前区域设置格式化日期/时间字符串。

### 语法2
按 C 风格格式化日期/时间字符串。如果格式控制字符串包含 % 字符，则运行时选择此风格。**cfrm** 包含一个或多个以 % 开头的代码，非 % 开头的字符直接复制。格式化代码如下：

| 代码 | 描述 |
|------|------|
| %a | 星期缩写 |
| %A | 星期全称 |
| %b | 月份缩写 |
| %B | 月份全称 |
| %c | 适合区域设置的日期和时间表示 |
| %d | 月中的日（01 - 31） |
| %H | 24 小时制小时（00 - 23） |
| %I | 12 小时制小时（01 - 12） |
| %j | 年中的日（001 - 366） |
| %m | 月份（01 - 12） |
| %M | 分钟（00 - 59） |
| %p | 当前区域的 AM/PM 指示符（12 小时制） |
| %S | 秒（00 - 59） |
| %U | 年中的周数，星期日为周首（00 - 51） |
| %w | 星期（0 - 6，星期日为 0） |
| %W | 年中的周数，星期一为周首（00 - 51） |
| %x | 当前区域的日期表示 |
| %X | 当前区域的时间表示 |
| %y | 无世纪的年份（00 - 99） |
| %Y | 带世纪的年份 |
| %z, %Z | 时区名称或缩写，若未知则无字符 |
| %% | 百分号 |

# 标志可前缀于任何格式化代码，改变其含义如下：

| 代码 | 描述 |
|------|------|
| %#a, %#A, %#b, %#B, %#p, %#X, %#z, %#Z, %#% | 忽略 # 标志 |
| %#c | 长日期和时间表示，例如 "Tuesday, March 14, 1995, 12:41:29" |
| %#x | 长日期表示，例如 "Tuesday, March 14, 1995" |
| %#d, %#H, %#I, %#j, %#m, %#M, %#S, %#U, %#w, %#W, %#y, %#Y | 移除前导零（若有） |

**locale**（语言）影响字符串格式化方式，可在控制面板区域设置中找到。

### 语法3
按 Windows 风格格式化日期/时间字符串。如果格式控制字符串不包含 % 字符，则运行时选择此风格。格式控制字符串中的字符序列会被替换为年、月等值，其他字符直接复制。为防止字符替换，用单引号括起来。

**winfrmdate**：

| 序列 | 描述 |
|------|------|
| d | 月中的日，数字 |
| dd | 月中的日，单数字前补零 |
| ddd | 星期三字母缩写 |
| dddd | 星期全称 |
| M | 月份，数字 |
| MM | 月份，单数字前补零 |
| MMM | 月份三字母缩写 |
| MMMM | 月份全称 |
| y | 年份后两位，少于 10 不补零 |
| yy | 年份后两位，少于 10 补零 |
| yyyy | 四位年份 |
| gg | 时代/时期字符串 |

**winfrmtime**：

| 序列 | 描述 |
|------|------|
| h | 12 小时制小时，单数字不补零 |
| hh | 12 小时制小时，单数字补零 |
| H | 24 小时制小时，单数字不补零 |
| HH | 24 小时制小时，单数字补零 |
| m | 分钟，单数字不补零 |
| mm | 分钟，单数字补零 |
| s | 秒，单数字不补零 |
| ss | 秒，单数字补零 |
| t | 单字符时间标记，如 A 或 P |
| tt | 多字符时间标记，如 AM 或 PM |

此函数无法格式化毫秒。