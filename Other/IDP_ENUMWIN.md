# 窗口/对象枚举回调函数

## 概述
回调函数是用户定义的函数，将其地址传递给支持回调的函数，该函数会多次调用回调函数，例如为每找到的对象提供信息。本主题介绍与 `win`、`child`、`acc` 和 `Acc.Find` 函数配合使用的回调函数，其他类似函数也支持回调。

回调函数适用于：
1. 获取窗口/对象数组。
2. 比较窗口/对象的更多属性。
3. 显示列表或树结构。
4. 跳过大型无用对象以提高速度。
5. 其他用途。

回调函数针对所有指定属性匹配的窗口/对象调用。若需针对所有窗口/对象调用，需将其他参数设为空（`""` 或 0）。对于 `win`，若需包含隐藏窗口，需在之前插入 `opt hidden 1`。

## win 和 child
- 在 `win` 和 `child` 函数中，回调函数及其参数在 `propCSV` 中指定，格式为：
  ```cpp
  F"callback=&Function {aValue}"
  ```
  （QM 2.3.4 之前使用 `x y` 和标志 0x8000）
- 搜索时，`win` 和 `child` 枚举顶级或子窗口，为每个匹配窗口调用回调函数。
- 回调函数必须以以下形式开头：
  ```cpp
  function# hwnd cbParam
  ```
  - **hwnd**：找到的窗口句柄。
  - **cbParam**：传递给 `win` 或 `child` 的回调函数参数。
- 返回值：
  - `1`：继续枚举。
  - `0`：停止枚举（让 `win` 或 `child` 返回 `hwnd`）。
- 回调函数可测试额外窗口属性（矩形、内部文本等），若匹配返回 0，否则返回 1。
- 模板：菜单 -> 文件 -> 新建 -> 模板。

## acc 和 Acc.Find
- 对于 `acc` 和 `Acc.Find`，回调函数必须以以下形式开头：
  ```cpp
  function# Acc&a level cbParam
  ```
  - **a**：找到的对象。
  - **level**：对象在层次结构中的级别。若指定 `class`，则为从该子窗口开始的级别。在网页搜索（标志 0x2000）中，为从网页根对象（DOCUMENT 或 PANE）开始的级别。
  - **cbParam**：`acc` 的 `y` 参数。
- 返回值：
  - `0`：停止搜索。
  - `1`：继续搜索并包括可能的子对象。
  - `2`：继续搜索但跳过子对象。
- 模板：菜单 -> 文件 -> 新建 -> 模板。