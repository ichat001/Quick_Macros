# 表达式类型与精度

## 概述
单运算符（主）表达式的类型和计算精度取决于具有更高精度类别的操作数。QM 中有以下四种精度类别，由低到高排序：

1. **int**（包括 `int`、`word`、`byte`）：表达式中，`word` 和 `byte` 隐式转换为 `int`。
2. **unsigned int**（包括指针，如 `lpstr` 和接口指针，以及无符号整数常量）。
3. **long**（`long` 类型）。
4. **double**（包括 `double` 和 OLE 类型）。

## 例外情况
- 若[运算符](IDH_OPERATORS.html)为逻辑或比较运算符，表达式类型为 `int`（结果为 0 或 1）。
- 若两个操作数均为 `lpstr` 或指针，且运算符为 `-`，表达式类型为 `int`（表示两个指针的差值）。
- 若操作数 1 为 `lpstr` 或指针，操作数 2 为 `int`（`int`、`byte` 或 `word`）或 `unsigned int`，表达式类型为操作数 1 的类型。
- 位运算符计算前，操作数转换为 `unsigned int` 或 `unsigned long`。
- 整数余数运算符 `%` 计算前，`double` 类型操作数转换为 `int` 或 `long`。

## 备注
复杂表达式的类型可通过拆分为主表达式（单运算符表达式）来确定。