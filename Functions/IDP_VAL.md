# 将字符串转换为数字

## 语法

```qm
int|long|double val(s [type] [length])
```

## 参数

- **s** - 包含数字开头的字符串。
- **type** - 返回类型：0 - `int`，1 - `long`，2 - `double`。默认：0。必须为常量。
- **length** - 接收从 **s** 开头到数字部分的结束的字符数的 `int` 变量。如果 **s** 不以数字开头或数字过大，则接收 0。

## 说明

返回字符串 **s** 的数值。如果字符串不以数字开头或数字过大，返回 0。

字符串可以包含整数或浮点 [数字](IDP_CONSTANT.md)。整数可以是十进制（如 `10`）或十六进制（如 `0x1C`）。浮点数格式为：

```qm
[sign][digits][.digits][(d|D|e|E)[sign]digits]
```

字符串可以以空格、制表符或符号（`-` 或 `+`）开头。

无论 **type** 如何，函数始终解析所有支持格式的完整数字。例如，`val("1.5E3")` 返回 `1500`。**type** 仅用于确定返回类型和检查范围。

QM 2.3.0 起：当 **type** 为 0 时，若数字在 `0x80000000` 到 `0xFFFFFFFF` 范围内，或 **type** 为 1 时在 `0x8000000000000000` 到 `0xFFFFFFFFFFFFFFFF` 范围内，函数返回负值。旧版 QM 会返回 0（数字过大）。

### 提示

将数字转换为字符串，使用 `str` 变量的 `=` 操作符。例如：

```qm
int i=5; str s; s=i ;; 现在 s 为 "5"
```

## 示例

```qm
str s1 s2; int i length; double d
s1="-100"
i=val(s1); out i
s2="4.757E2"
d=val(s2 2 length); out d; out length
;; 输出：
;; -100
;; 475.7
;; 7
```