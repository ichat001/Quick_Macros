# 触发器：事件日志

事件日志触发器在 Windows 事件日志添加新事件时启动宏。通过 [Properties](IDH_PROPERTIES.md) 对话框分配此触发器。

## 概述

Windows 和应用程序将重要事件记录到 Windows 事件日志，可在 **事件查看器** 中查看。例如：
- 应用程序因错误关闭
- 网络连接/断开
- 服务启动/停止/暂停
- 其他错误或信息

事件日志包括 **System**、**Application**、**Security** 等多个日志。每个事件包含：
- **事件源**：记录事件的应用程序或服务。
- **事件 ID**：事件源内唯一标识事件的编号。
- **消息**：事件相关文本信息，通常由事件 ID 关联的固定文本和特定事件的插入字符串组成。

## 消息检索

- **Retrieve full message**：
  - 未勾选：仅检索插入字符串（以空格分隔），速度快。
  - 勾选：检索完整消息，需加载包含文本的 DLL，速度较慢。
- 因可指定事件 ID，通常无需完整消息即可识别事件。
- **Message** 字段支持通配符 `*` 和 `?`。

## 触发器信息

宏可通过关闭 **Properties** 对话框时插入的 [function](IDP_FUNCTION.md) 语句接收触发器信息（需确认）。

## 注意事项

- 事件日志触发器在权限受限的用户账户下无效，因无法访问事件日志。