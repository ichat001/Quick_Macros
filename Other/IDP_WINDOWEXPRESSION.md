# 窗口表达式（Window Expressions）

## 概述

在宏命令中需要指定窗口时，可使用以下方式：

### 1. 窗口名称（name）
- **描述**：窗口标题栏显示的文本，可部分匹配，区分大小写，需用引号括起（变量除外）。
- **搜索范围**：默认仅搜索可见窗口，除非设置 [运行时选项](IDP_OPT.html) `opt hidden 1`。
- **正则表达式**：若名称以 `$` 开头（但非 `$$`），视为 [正则表达式](IDP_PCRE.html)。例如：
  - `"$^A.*Notepad$"`：匹配以“A”开头、“Notepad”结尾的窗口名称。
  - `"(?i)^A.*Notepad$"`：不区分大小写的正则表达式。
- **空字符串**：`""` 通常表示当前活动窗口。
- **示例**：
  ```qm
  act "Notepad"

  str s="Notepad"
  act s
  ```

### 2. 窗口类名（class）
- **描述**：窗口类名，需完整匹配或使用通配符（**QM 2.3.4**），不区分大小写，需以 `+` 前缀。
- **搜索范围**：搜索所有窗口。
- **示例**：
  ```qm
  act "+ieframe"
  ```

### 3. 窗口名称/类名列表
- **描述**：用 `[]`（换行）分隔多个窗口名称或 `+` 类名，依次查找，若第一个未找到则尝试下一个。
- **示例**：
  ```qm
  ifa "Window1[]$Window\d[]+Window3"
      out "One of three windows is active"
  ```

### 4. 窗口句柄（handle）
- **描述**：窗口的唯一整数值，适用于用户定义函数和 DLL 函数。由 [win](IDP_WIN.html)、[id](IDP_ID.html)、[child](IDP_CHILD.html) 等函数返回。
- **示例**：
  ```qm
  int h=win("Notepad")
  act h

  act win("Notepad")
  ```

- **变量存储**：窗口表达式（句柄或名称等）可存储在 `VARIANT` 类型变量中。
- **等待时间**：若窗口不存在，宏命令默认等待最多 0.5 秒，除非 [speed](IDP_SPE.html) 为 0 或使用窗口句柄（变量或除 `win` 外的函数）。

## 术语说明

- **窗口名称（name）**：窗口标题栏显示的文本。
- **窗口类（class）**：定义窗口外观和行为的类别，由开发者设置，不可更改。某些窗口类（如以 `Afx:` 开头）每次创建可能不同。可在 QM 状态栏查看窗口名称和类名。
- **窗口句柄（handle）**：系统创建窗口时分配的唯一数字值，窗口销毁前不变。
- **子窗口 ID（id）**：开发者为子窗口分配的数字值，通常在父窗口内唯一，运行时可能为随机值。

## 相关内容

- [窗口样式](IDP_WINDOWSTYLES.html)