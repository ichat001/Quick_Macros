# QM 项目

Quick Macros (QM) 支持以下项目类型：

- **宏** ![宏图标](../image/icon_macro.gif)  
  用于执行宏命令和函数，参见[宏](IDH_MACRO.html)。默认一次仅运行一个宏，运行时托盘图标变红，可按 Pause 键手动停止。  
  QM 2.4.2：新增选项“若宏正在运行，同时运行”，详见[此处](IDH_MACRO.html)。

- **函数** ![函数图标](../image/icon_function.gif)  
  可从代码（宏、函数等）调用，也可像宏一样启动，参见[函数](IDH_FUNCTION.html)。宏和函数代码相同，主要区别在于用途：  
  - **宏**：用于自动化，特别与窗口交互（发送按键等），更安全（单一实例、红色托盘图标、Pause 键停止），常用于测试代码。  
  - **函数**：常用于：  
    - 在多处执行相同代码（调用含代码的函数）。  
    - 回调函数等必需函数的场景。  
    - 后台任务或长时间无人值守任务（如应用程序或服务），通常不与窗口交互，不干扰用户操作或其他任务。带“同时运行”选项的宏也可用于此。  
  默认速度 ([spe](../Commands/IDP_SPE.html))：函数及成员函数为 0，宏及其他类型为 100，可通过 [RtOptions](../User/IDP_QMDLL.html#RtOptions) 更改。  
  **另见**：[子函数](../Language/IDP_DIR_SUB.html)。

- **成员函数** ![成员函数图标](../image/icon_member.gif)  
  属于类的函数，调用方式与普通函数不同，不可设置触发器或启动线程，参见[类成员函数](../Language/IDP_CLASSES.html)。

- **弹出菜单** ![弹出菜单图标](../image/icon_popup.gif)  
  用于启动宏、文件或执行其他命令，参见[弹出菜单](IDH_POPUP.html)。

- **工具栏** ![工具栏图标](../image/icon_toolbar.gif)  
  用于启动宏、文件或执行其他命令，可关联窗口（窗口出现时自动运行，关闭时消失）或独立存在（始终置顶），参见[工具栏](IDH_TOOLBAR.html)。

- **自动文本列表** ![自动文本列表图标](../image/icon_tsm.gif)  
  也称 TS 菜单，用于在输入特定文本时执行命令，可用于文本替换、自动完成或自动更正，参见[自动文本列表](IDH_TSM.html)。

- **文件夹**  
  用于存储项目，参见[文件夹属性](IDH_FOLDERPROP.html)。

## 项目属性
每个项目有名称、可设置触发器（启动事件）、代码（文本）及其他属性。

## 创建与管理项目
- **新建宏**：点击工具栏“新建宏”按钮。
- **新建其他类型**：点击“新建宏”旁的小箭头，从菜单选择，或在项目列表右键选择“新建”子菜单。在列表中小编辑框输入名称。
- **设置属性**：使用“属性”对话框（点击工具栏“属性”按钮）设置触发器等。
- **删除项目**：在项目列表右键点击项目，选择“删除”，或选中后按 Delete 键。

## 文件链接 (QM 2.3.0)
新增项目类型“文件链接”，用于在 QM 中打开文本文件进行查看和编辑，类似文件快捷方式，文件内容不存储在[QM 文件](IDH_QML.html)中，删除或重命名不影响原文件。  
- **创建方式**：  
  - 从 Windows 资源管理器拖放文件到 QM 项目列表。  
  - 用 QM 打开文件（如拖放到 QM 图标）。  
  - 使用 [newitem](../Functions/IDP_NEWITEM.html) 函数。  
- **功能**：可设置触发器或通过“运行”按钮启动，默认无操作。需创建函数并分配触发器 [QM 事件 -> 文件链接运行](IDH_TRIG_QM.html) 来运行文件或执行其他操作。

## 自定义图标 (QM 2.3.0)
QM 项目可设置自定义[图标](IDH_ICONS.html)。